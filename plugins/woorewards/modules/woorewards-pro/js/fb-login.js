jQuery(function($){if('y'!=lws_webhooks_facebook.known){if(undefined==FB){$('.lws_webhooks_facebook_login_blocked').removeClass('hidden')}else{lws_webhooks_facebook.permissions={};lws_webhooks_facebook.saveData=function(remoteId){lws_webhooks_facebook.remote_id=remoteId;FB.api('/'+lws_webhooks_facebook.remote_id,{fields:'name'},function(response){$.ajax({url:lws_webhooks_facebook.url,data:{action:'lws_webhooks_register_account',social:'facebook',remote_name:response.name,remote_inapp:lws_webhooks_facebook.remote_id,nonce:lws_webhooks_facebook.nonce},success:function(data){$('.lws_webhooks_facebook_login_button').removeClass('loading');if(undefined!=data.status&&'success'==data.status){$('.lws_webhooks_facebook_login_button').addClass('hidden');$('.lws_webhooks_facebook_login_ok').removeClass('hidden')}}}).fail(function(jqXHR,textStatus){$('.lws_webhooks_facebook_login_button').removeClass('loading')})})};window.fbAsyncInit=function(){FB.init({appId:lws_webhooks_facebook.app_id,version:lws_webhooks_facebook.version,cookie:!0});FB.getLoginStatus(function(response){lws_webhooks_facebook.status=response.status;lws_webhooks_facebook.remote_id='';if('unknown'!=response.status){if(undefined!==response.authResponse&&response.authResponse&&undefined!==response.authResponse.userID){lws_webhooks_facebook.saveData(response.authResponse.userID)}}
if(lws_webhooks_facebook.remote_id.length){if(Object.entries(lws_webhooks_facebook.permissions).length){FB.api('/'+lws_webhooks_facebook.remote_id+'/permissions',function(response){for(const p in lws_webhooks_facebook.permissions){for(let i=0;i<response.data.length;++i){if(response.data[i].permission==lws_webhooks_facebook.permissions[p]&&response.data[i].status=='granted'){lws_webhooks_facebook.permissions[p]=!0}}}});lws_webhooks_facebook.needMore=undefined;for(const p in lws_webhooks_facebook.permissions){if(!lws_webhooks_facebook.permissions[p]){lws_webhooks_facebook.needMore=p;$('.lws_webhooks_facebook_login_button').removeClass('hidden');break}}}}else{$('.lws_webhooks_facebook_login_button').removeClass('hidden')}})}}}else{if('y'==lws_webhooks_facebook.verified){$('.lws_webhooks_facebook_login_verified').removeClass('hidden')}else{$('.lws_webhooks_facebook_login_ok').removeClass('hidden')}}
$('body').on('click','.lws_webhooks_facebook_login_button',function(e){e.preventDefault();$('.lws_webhooks_facebook_login_button').addClass('loading');let opt={return_scopes:!0,enable_profile_selector:!0};let scopes=[];for(const p in lws_webhooks_facebook.permissions)
scopes.push(p);opt.scope=scopes.join(',');if(lws_webhooks_facebook.needMore){opt.auth_type='rerequest'}
FB.login(function(response){if('connected'==response.status){lws_webhooks_facebook.status=response.status;lws_webhooks_facebook.saveData(response.authResponse.userID)}else{$('.lws_webhooks_facebook_login_button').removeClass('loading')}},opt);return!1})})