jQuery(function($){$(document.body).on('updated_cart_totals wc_fragments_loaded updated_checkout',function(e){$(".lws_popup").lws_popup()});$(document).on('change','.wr_free_product_popup input[name="free_product_selection"]',function(e){var popup=$(e.target).closest('.wr_free_product_popup');popup.find('.wr_free_product_popup_apply').removeClass('disabled')});$(document).on('popup_closed','.wr_free_product_popup',function(e){e.preventDefault();var popup=$(e.target).closest('.wr_free_product_popup');var coupon=popup.data('code');popup.addClass('loading');popup.find('input').prop('disabled',!0);var row=$('#lws_woorewards_coupons').find('.lws_wr_cart_coupon_row.coupon-'+coupon);if(row.length){row.show();$('.lws-wre-cartcouponsview-main').show()}
$.ajax({url:popup.data('ajaxurl'),data:{action:'woorewards_free_product_switch_in_cart',code:coupon,},success:function(data){if(data.success!=undefined){btn=$('.woocommerce-cart-form button[name="update_cart"], .woocommerce-cart-form input[name="update_cart"]');if(btn.length){btn.prop('disabled',!1);btn.trigger('click');$('.wr_free_product_popup[data-code="'+popup.data('code')+'"]').remove()}else{location.reload()}}else alert(data.error!=undefined?data.error:'An error occured, refresh the page and try again.')}}).fail(function(jqXHR,textStatus){console.log(textStatus)});return!1});$(document).on('click','.wr_free_product_popup .wr_free_product_popup_apply',function(e){e.preventDefault();var popup=$(e.target).closest('.wr_free_product_popup');var selected=popup.find('input[name="free_product_selection"]:checked');if(selected.length<=0){return!1}
popup.addClass('loading');popup.find('input, button').prop('disabled',!0);$.ajax({url:popup.data('ajaxurl'),data:{action:'woorewards_free_product_switch_in_cart',code:popup.data('code'),product:selected.val(),},success:function(data){if(data.success!=undefined){btn=$('.woocommerce-cart-form button[name="update_cart"], .woocommerce-cart-form input[name="update_cart"]');if(btn.length){btn.prop('disabled',!1);btn.trigger('click');$('.wr_free_product_popup[data-code="'+popup.data('code')+'"]').remove()}else{location.reload()}}else alert(data.error!=undefined?data.error:'An error occured, refresh the page and try again.')}}).fail(function(jqXHR,textStatus){console.log(textStatus)});return!1})})