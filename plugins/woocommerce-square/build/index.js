!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=32)}([function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.regeneratorRuntime},function(e,t,r){var n=r(14);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=window.React},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(3));t.Context=a.createContext({applePayState:"loading",formId:"",googlePayState:"loading",masterpassState:"loading",onCreateNonce:function(){},onVerifyBuyer:function(e,t,r){}}),t.default=t.Context},function(e,t){function r(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var i=e.apply(t,n);function u(e){r(i,a,o,u,l,"next",e)}function l(e){r(i,a,o,u,l,"throw",e)}u(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(16),a=r(17),o=r(18),i=r(20);e.exports=function(e,t){return n(e)||a(e,t)||o(e,t)||i()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";var n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(r(3)),u=o(r(21)),l=o(r(4));t.SquarePaymentForm=function(e){var t=e.apiWrapper,r=void 0===t?"reactjs/0.7.3":t,a=e.formId,o=void 0===a?"sq-payment-form":a,s=e.inputStyles,c=void 0===s?[{_mozOsxFontSmoothing:"grayscale",_webkitFontSmoothing:"antialiased",backgroundColor:"transparent",color:"#373F4A",fontFamily:"Helvetica Neue",fontSize:"16px",lineHeight:"24px",padding:"16px",placeholderColor:"#CCC"}]:s,d=e.sandbox,f=void 0!==d&&d,p=n(e,["apiWrapper","formId","inputStyles","sandbox"]),m=i.useState("loading"),v=m[0],y=m[1],b=i.useState("loading"),g=b[0],h=b[1],_=i.useState("loading"),O=_[0],S=_[1],C=i.useState(""),x=C[0],j=C[1],P=i.useState(!1),E=P[0],w=P[1],q=i.useState(void 0),I=q[0],M=q[1],R=i.useState(!1),k=R[0],D=R[1],N=u.default((function(e,t,r,n,a,o){!e&&p.createVerificationDetails?I&&I.verifyBuyer(t,p.createVerificationDetails(),(function(e,i){p.cardNonceResponseReceived(e?[e]:null,t,r,i?i.token:void 0,n,a,o)})):p.cardNonceResponseReceived(e,t,r,"",n,a,o)}));function T(e){var t=Object.keys(e);t.includes("masterpass")&&S(!0===e.masterpass?"ready":"unavailable"),t.includes("applePay")&&y(!0===e.applePay?"ready":"unavailable"),t.includes("googlePay")&&h(!0===e.googlePay?"ready":"unavailable"),p.methodsSupported&&p.methodsSupported(e)}var B=function(){D(!0),p.paymentFormLoaded&&p.paymentFormLoaded()};if(i.useEffect((function(){k&&I&&(I.recalculateSize(),p.postalCode&&I.setPostalCode(p.postalCode()),p.focusField&&I.focus(p.focusField()))}),[k,I]),i.useEffect((function(){!function(e,t){if(document.getElementById("sq-payment-form-script")&&"function"==typeof SqPaymentForm)e&&e();else{var r=document.createElement("script");r.id="sq-payment-form-script",r.src=f?"https://js.squareupsandbox.com/v2/paymentform":"https://js.squareup.com/v2/paymentform",r.onload=function(){e&&e()},r.onerror=function(){t&&t()},document.body.appendChild(r)}}((function(){return w(!0)}),(function(){return j("Unable to load Square payment library")}))}),[]),i.useEffect((function(){return function(){if(!(!E||I||x.length>0))try{var e=new SqPaymentForm(function(e){var t={apiWrapper:r,applicationId:e.applicationId,autoBuild:!1,callbacks:{cardNonceResponseReceived:e.cardNonceResponseReceived?N:null,createPaymentRequest:e.createPaymentRequest,inputEventReceived:e.inputEventReceived,methodsSupported:T,paymentFormLoaded:B,shippingContactChanged:e.shippingContactChanged,shippingOptionChanged:e.shippingOptionChanged,unsupportedBrowserDetected:e.unsupportedBrowserDetected},locationId:e.locationId};return document.getElementById(e.formId+"-sq-card")?t.card={elementId:o+"-sq-card",inputStyle:c&&c[0]}:document.getElementById(o+"-sq-gift-card")?(t.giftCard={elementId:o+"-sq-gift-card",placeholder:e.placeholderGiftCard||"• • • •  • • • •  • • • •  • • • •"},t.inputClass=e.inputClass||"sq-input",t.inputStyles=c):(t.inputClass=e.inputClass||"sq-input",t.inputStyles=c,document.getElementById(o+"-sq-apple-pay")&&(t.applePay={elementId:o+"-sq-apple-pay"}),document.getElementById(o+"-sq-google-pay")&&(t.googlePay={elementId:o+"-sq-google-pay"}),document.getElementById(o+"-sq-masterpass")&&(t.masterpass={elementId:o+"-sq-masterpass"}),document.getElementById(o+"-sq-card-number")&&(t.cardNumber={elementId:o+"-sq-card-number",placeholder:e.placeholderCreditCard||"• • • •  • • • •  • • • •  • • • •"}),document.getElementById(o+"-sq-cvv")&&(t.cvv={elementId:o+"-sq-cvv",placeholder:e.placeholderCVV||"CVV "}),document.getElementById(o+"-sq-postal-code")?t.postalCode={elementId:o+"-sq-postal-code",placeholder:e.placeholderPostal||"12345"}:t.postalCode=!1,document.getElementById(o+"-sq-expiration-date")&&(t.expirationDate={elementId:o+"-sq-expiration-date",placeholder:e.placeholderExpiration||"MM/YY"})),t}(p));e.build(),M(e)}catch(e){var t=e.message||"Unable to build Square payment form";j(t)}}(),function(){I&&(I.destroy(),M(void 0))}}),[E]),i.useEffect((function(){if(I&&"ready"===O){var e=document.getElementById(o+"-sq-masterpass");if(e){var t=I.masterpassImageUrl();e.style.display="inline-block",e.style.backgroundImage="url("+t+")"}}}),[I,O]),x)return i.default.createElement("div",{className:"sq-payment-form"},i.default.createElement("div",{className:"sq-error-message"},x));var V={applePayState:v,formId:o,googlePayState:g,masterpassState:O,onCreateNonce:function(){I&&I.requestCardNonce()},onVerifyBuyer:function(e,t,r){I&&I.verifyBuyer(e,t,r)}};return i.default.createElement(l.default.Provider,{value:V},i.default.createElement("div",{id:o,className:"sq-payment-form"},p.children))}},function(e,t){e.exports=window.wc.wcBlocksRegistry},function(e,t,r){var n=r(13);e.exports=function(e,t){if(null==e)return{};var r,a,o=n(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=window.wc.wcSettings},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var a=r(8);n(r(22)),n(r(4)),n(r(23)),n(r(24)),n(r(25)),n(r(26)),n(r(27)),n(r(28)),n(r(29)),n(r(30)),n(r(31)),n(r(8)),t.default=a.SquarePaymentForm},function(e,t){e.exports=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(7).default,a=r(15);e.exports=function(e){var t=a(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(7).default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,_x,o,i=[],_n=!0,u=!1;try{if(_x=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;_n=!1}else for(;!(_n=(n=_x.call(r)).done)&&(i.push(n.value),i.length!==t);_n=!0);}catch(e){u=!0,a=e}finally{try{if(!_n&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(19);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.default=function(e){var t=n.useRef(e);return n.useLayoutEffect((function(){t.current=e}),[e]),n.useCallback((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.current.apply(t,e)}),[])}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.ApplePayButton=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,o.default.createElement("button",{id:t.formId+"-sq-apple-pay",className:"sq-apple-pay",style:{display:"ready"===t.applePayState?"block":"none"}}),"loading"===t.applePayState&&e.loadingView,"unavailable"===t.applePayState&&e.unavailableView)}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.CreditCardCVVInput=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,e.label&&o.default.createElement("span",{className:"sq-label"},e.label),o.default.createElement("div",{id:t.formId+"-sq-cvv"}))},t.CreditCardCVVInput.defaultProps={label:"CVV"}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.CreditCardExpirationDateInput=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,e.label&&o.default.createElement("span",{className:"sq-label"},e.label),o.default.createElement("div",{id:t.formId+"-sq-expiration-date"}))},t.CreditCardExpirationDateInput.defaultProps={label:"Expiration"}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.CreditCardNumberInput=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,e.label&&o.default.createElement("span",{className:"sq-label"},e.label),o.default.createElement("div",{id:t.formId+"-sq-card-number"}))},t.CreditCardNumberInput.defaultProps={label:"Credit Card"}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.CreditCardPostalCodeInput=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,e.label&&o.default.createElement("span",{className:"sq-label"},e.label),o.default.createElement("div",{id:t.formId+"-sq-postal-code"}))},t.CreditCardPostalCodeInput.defaultProps={label:"Postal"}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.CreditCardSubmitButton=function(e){var t=o.useContext(i.default);return o.default.createElement("button",{disabled:e.disabled,className:"sq-creditcard",onClick:t.onCreateNonce},e.children?e.children:"Pay")},t.CreditCardSubmitButton.defaultProps={disabled:!1}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.GiftCardInput=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,e.label&&o.default.createElement("span",{className:"sq-label"},e.label),o.default.createElement("div",{id:t.formId+"-sq-gift-card"}))},t.GiftCardInput.defaultProps={label:"Gift Card"}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.GooglePayButton=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,o.default.createElement("button",{id:t.formId+"-sq-google-pay",className:"sq-google-pay",style:{display:"ready"===t.googlePayState?"block":"none"}}),"loading"===t.googlePayState&&e.loadingView,"unavailable"===t.googlePayState&&e.unavailableView)}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.MasterpassButton=function(e){var t=o.useContext(i.default);return o.default.createElement("div",null,o.default.createElement("button",{id:t.formId+"-sq-masterpass",className:"sq-masterpass",style:{display:"ready"===t.masterpassState?"block":"none"}}),"loading"===t.masterpassState&&e.loadingView,"unavailable"===t.masterpassState&&e.unavailableView)}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3)),i=a(r(4));t.SimpleCard=function(){var e=o.useContext(i.default);return o.default.createElement("div",{id:e.formId+"-sq-card"})}},function(e,t,r){"use strict";r.r(t);var n=r(9),a=r(10),o=r.n(a),i=r(0),u=r(2),l=r.n(u),s=r(5),c=r.n(s),d=r(1),f=r.n(d);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=Object(i.createContext)(!1),y=function(e){var t=e.checkoutFormHandler,r=e.eventRegistration,n=e.emitResponse,a=Object(i.useContext)(v),o=r.onPaymentProcessing,u=r.onCheckoutAfterProcessingWithError,l=r.onCheckoutAfterProcessingWithSuccess;return function(e,t,r,n,a,o){var u=Object(i.useRef)(r);Object(i.useEffect)((function(){u.current=r}),[r]),Object(i.useEffect)((function(){return e(function(){var e=c()(f.a.mark((function e(){var r,i,l,s,c,d,p,v;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={type:t.responseTypes.SUCCESS},s={nonce:"",notices:[],logs:[]},e.next=4,a(u.current.card);case 4:if(c=e.sent,d=m(m({},s),{},{nonce:c.token}),null!=c&&null!==(r=c.details)&&void 0!==r&&r.card&&null!=c&&null!==(i=c.details)&&void 0!==i&&i.billing&&(d.cardData=m(m({},c.details.card),c.details.billing)),!(p=d.token||d.nonce)){e.next=15;break}return e.next=11,o(u.current.payments,p);case 11:v=e.sent,d.verificationToken=v.verificationToken||"",d.logs=d.logs.concat(v.log||[]),d.errors=d.notices.concat(v.errors||[]);case 15:return p||d.logs.length>0?l.meta={paymentMethodData:n(d)}:d.notices.length>0&&(l.type=t.responseTypes.ERROR,l.message=d.notices),e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}())}),[e,t.responseTypes.SUCCESS,t.responseTypes.ERROR,a,o,n])}(o,n,a,t.getPaymentMethodData,t.createNonce,t.verifyBuyer),function(e,t,r){Object(i.useEffect)((function(){var n=function(e){var t={type:r.responseTypes.SUCCESS},n=e.processingResponse,a=n.paymentStatus,o=n.paymentDetails;return a===r.responseTypes.ERROR&&o.checkoutNotices&&(t={type:r.responseTypes.ERROR,message:JSON.parse(o.checkoutNotices),messageContext:r.noticeContexts.PAYMENTS,retry:!0}),t},a=e(n),o=t(n);return function(){a(),o()}}),[e,t,r.noticeContexts.PAYMENTS,r.responseTypes.ERROR,r.responseTypes.SUCCESS])}(u,l,n),null},b=r(6),g=r.n(b),h=r(11);function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return O(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw o}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var S=null,C=function(){if(null!==S)return S;var e=Object(h.getSetting)("square_credit_card_data",null);if(!e)throw new Error("Square initialization data is not available");return S={title:e.title||"",applicationId:e.application_id||"",locationId:e.location_id||"",isSandbox:e.is_sandbox||!1,inputStyles:e.input_styles||[],availableCardTypes:e.available_card_types||{},loggingEnabled:e.logging_enabled||!1,generalError:e.general_error||"",showSavedCards:e.show_saved_cards||!1,showSaveOption:e.show_save_option||!1,supports:e.supports||{},isTokenizationForced:e.is_tokenization_forced||!1}},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{logs:[],notices:[]},r=!1;if(e){var n=["none","cardNumber","expirationDate","cvv","postalCode"];e.length>=1&&e.sort((function(e,t){return n.indexOf(e.field)-n.indexOf(t.field)}));var a,o=_(e);try{for(o.s();!(a=o.n()).done;){var i=a.value;"UNSUPPORTED_CARD_BRAND"===i.type||"VALIDATION_ERROR"===i.type?(t.notices.push(i.message.replace(/CVV/,"CSC")),r=!0):P(i,t)}}catch(e){o.e(e)}finally{o.f()}}r||t.notices.push(C().generalError)},j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"notice";C().loggingEnabled&&("error"===t?console.error(e):console.log(e))},P=function(e,t){C().loggingEnabled&&t&&t.logs.push(e)},E=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=Object(i.useState)(!1),a=g()(n,2),o=a[0],u=a[1],s=Object(i.useState)(""),d=g()(s,2),p=d[0],m=d[1],v=Object(i.useRef)(null),y=Object(i.useRef)(null),b=Object(i.useMemo)((function(){var n=t&&!r?"STORE":"CHARGE",a={billingContact:{familyName:e.billingData.last_name||"",givenName:e.billingData.first_name||"",email:e.billingData.email||"",country:e.billingData.country||"",region:e.billingData.state||"",city:e.billingData.city||"",postalCode:e.billingData.postcode||"",phone:e.billingData.phone||"",addressLines:[e.billingData.address_1||"",e.billingData.address_2||""]},intent:n};return"CHARGE"===n&&(a.amount=(e.cartTotal.value/100).toString(),a.currencyCode=e.currency.code),a}),[e.billingData,e.cartTotal.value,e.currency.code,t,r]),h=Object(i.useCallback)((function(e){var n,a,o,i=e.cardData,u=void 0===i?{}:i,s=e.nonce,c=e.verificationToken,d=e.notices,f=e.logs;return o={},l()(o,"wc-".concat("square-credit-card","-card-type"),p||""),l()(o,"wc-".concat("square-credit-card","-last-four"),(null==u?void 0:u.last4)||""),l()(o,"wc-".concat("square-credit-card","-exp-month"),(null==u||null===(n=u.expMonth)||void 0===n?void 0:n.toString())||""),l()(o,"wc-".concat("square-credit-card","-exp-year"),(null==u||null===(a=u.expYear)||void 0===a?void 0:a.toString())||""),l()(o,"wc-".concat("square-credit-card","-payment-postcode"),(null==u?void 0:u.postalCode)||""),l()(o,"wc-".concat("square-credit-card","-payment-nonce"),s||""),l()(o,"wc-".concat("square-credit-card","-payment-token"),r||""),l()(o,"wc-".concat("square-credit-card","-buyer-verification-token"),c||""),l()(o,"wc-".concat("square-credit-card","-tokenize-payment-method"),t||!1),l()(o,"log-data",f.length>0?JSON.stringify(f):""),l()(o,"checkout-notices",d.length>0?JSON.stringify(d):""),o}),[p,t,r]),_=function(e,t,r){var n={notices:[],logs:[]};e?x(e,n):t?(P(r,n),j("Card data received"),j(r),n.cardData=r,n.nonce=t):(P("Nonce is missing from the Square response",n),j("Nonce is missing from the Square response","error"),x([],n)),v.current&&v.current(n)},O=Object(i.useCallback)(function(){var e=c()(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=4;break}return e.next=3,t.tokenize();case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(_x){return e.apply(this,arguments)}}(),[r]),S=Object(i.useCallback)(function(){var e=c()(f.a.mark((function e(t,r){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.verifyBuyer(r,b);case 3:return n=e.sent,e.abrupt("return",E(n));case 7:e.prev=7,e.t0=e.catch(0),x([e.t0]);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),[b,E]),E=Object(i.useCallback)((function(e){var t={notices:[],logs:[]};return e&&e.token?t.verificationToken=e.token:(P("Verification token is missing from the Square response",t),j("Verification token is missing from the Square response","error"),x([],t)),t}),[y]),w=Object(i.useCallback)((function(e){if("cardBrandChanged"===e.eventType){var t=e.cardBrand,r="plain";null!==t&&"unknown"!==t||(r=""),null!==C().availableCardTypes[t]&&(r=C().availableCardTypes[t]),j("Card brand changed to ".concat(t)),m(r)}}),[]),q=Object(i.useCallback)((function(){return e.billingData.postcode||""}),[e.billingData.postcode]);return{cardNonceResponseReceived:_,handleInputReceived:w,isLoaded:o,setLoaded:u,getPostalCode:q,cardType:p,createNonce:O,verifyBuyer:S,getPaymentMethodData:h}},w=function(e){var t=e.children,r=e.defaults.postalCode,n=void 0===r?"":r,a=Object(i.useState)(!1),o=g()(a,2),u=o[0],l=o[1],s=Object(i.useState)(!1),d=g()(s,2),p=d[0],m=d[1],y=C(),b=y.applicationId,h=y.locationId;return Object(i.useEffect)((function(){!u&&window.Square&&l(window.Square.payments(b,h))}),[u]),Object(i.useEffect)((function(){u&&!p&&function(){var e=c()(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.card({postalCode:n});case 2:t=e.sent,m(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[u]),u?Object(i.createElement)(v.Provider,{value:{payments:u,card:p}},t):null},q=function(){var e=Object(i.useContext)(v).card,t=Object(i.useRef)(!1);return Object(i.useEffect)((function(){e&&function(){var r=c()(f.a.mark((function r(){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.attach(t.current);case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()()}),[e]),Object(i.createElement)("div",{ref:t})},I=function(e){var t=e.billing,r=e.eventRegistration,n=e.emitResponse,a=e.shouldSavePayment,o=C().isTokenizationForced,u=E(t,a||o);return Object(i.createElement)(w,{defaults:{postalCode:u.getPostalCode()}},Object(i.createElement)(q,null),Object(i.createElement)(y,{checkoutFormHandler:u,eventRegistration:r,emitResponse:n}))},M=r(12),R=["RenderedComponent"],k=function(e){var t=e.RenderedComponent,r=o()(e,R);return Object(i.createElement)(t,r)},D={name:"square-credit-card",label:Object(i.createElement)((function(e){var t=e.components.PaymentMethodLabel;return Object(i.createElement)(t,{text:C().title})}),null),content:Object(i.createElement)(k,{RenderedComponent:I}),edit:Object(i.createElement)(k,{RenderedComponent:I}),savedTokenComponent:Object(i.createElement)(k,{RenderedComponent:function(e){var t=e.billing,r=e.eventRegistration,n=e.emitResponse,a=e.token,o=E(t,!1,a);return Object(i.createElement)(M.SquarePaymentForm,{formId:"square-credit-card-saved-card",sandbox:C().isSandbox,applicationId:C().applicationId,locationId:C().locationId,paymentFormLoaded:function(){return o.setLoaded(!0)}},o.isLoaded&&Object(i.createElement)(y,{checkoutFormHandler:o,eventRegistration:r,emitResponse:n}))}}),paymentMethodId:"square_credit_card",ariaLabel:"Square",canMakePayment:function(){return!(!C().applicationId||!C().locationId)},supports:{features:C().supports,showSavedCards:C().showSavedCards,showSaveOption:C().showSaveOption}};Object(n.registerPaymentMethod)(D)}]);